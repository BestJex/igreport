(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d7ff988"],{"5bdb":function(e,t,r){},c9eb:function(e,t,r){"use strict";r.r(t);var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"container",staticStyle:{width:"1000px"}},[r("div",{staticClass:"form-box"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"1000px"},attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"报表名称",prop:"reportName"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"仅支持英文和下划线且不能以下划线开头结尾"},model:{value:e.ruleForm.reportName,callback:function(t){e.$set(e.ruleForm,"reportName",t)},expression:"ruleForm.reportName"}}),r("el-button",{staticStyle:{"margin-left":"10px",color:"gray"},attrs:{type:"text"}},[e._v("例:new_user_report")])],1),r("el-form-item",{attrs:{label:"报表描述",prop:"reportDesc"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入报表中文名"},model:{value:e.ruleForm.reportDesc,callback:function(t){e.$set(e.ruleForm,"reportDesc",t)},expression:"ruleForm.reportDesc"}}),r("el-button",{staticStyle:{"margin-left":"10px",color:"gray"},attrs:{type:"text"}},[e._v("例:新客日报")])],1),r("el-form-item",{attrs:{label:"数据源",prop:"dataSource"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.dataSource,callback:function(t){e.$set(e.ruleForm,"dataSource",t)},expression:"ruleForm.dataSource"}},[r("el-option",{key:"tidb",attrs:{label:"TIDB",value:"tidb"}}),r("el-option",{key:"mysql",attrs:{label:"MYSQL",value:"mysql"}}),r("el-option",{key:"presto",attrs:{label:"Presto",value:"presto"}}),r("el-option",{key:"pgxl",attrs:{label:"Pgxl",value:"pgxl"}})],1)],1),r("el-form-item",{attrs:{label:"调度频率",prop:"jobCron"}},[r("el-input",{staticStyle:{width:"208px"},attrs:{placeholder:"请输入cron表达式"},model:{value:e.ruleForm.jobCron,callback:function(t){e.$set(e.ruleForm,"jobCron",t)},expression:"ruleForm.jobCron"}}),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){e.cronDialogVisible=!0}}},[e._v("查看示例")])],1),r("el-form-item",{attrs:{label:"授权用户",prop:"authorizedPeople"}},[r("el-select",{staticStyle:{width:"500px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:e.ruleForm.authorizedPeople,callback:function(t){e.$set(e.ruleForm,"authorizedPeople",t)},expression:"ruleForm.authorizedPeople"}},e._l(e.reportUser,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"元数据格式",prop:"metaDataJson"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",rows:"3",placeholder:"报表表头,请输入json字符串"},model:{value:e.ruleForm.metaDataJson,callback:function(t){e.$set(e.ruleForm,"metaDataJson",t)},expression:"ruleForm.metaDataJson"}}),r("el-button",{staticStyle:{"margin-left":"10px",color:"gray"},attrs:{type:"text"}},[e._v('例:{"register_num":"注册人数","aps_num":"授信人数"}')])],1),r("el-form-item",{attrs:{label:"报表时间",prop:"reportFrequency"}},[r("el-radio-group",{model:{value:e.ruleForm.reportFrequency,callback:function(t){e.$set(e.ruleForm,"reportFrequency",t)},expression:"ruleForm.reportFrequency"}},[r("el-radio",{attrs:{label:"按天"}}),r("el-radio",{attrs:{label:"按小时"}}),r("el-radio",{attrs:{label:"按半小时"}}),r("el-radio",{attrs:{label:"自定义"}})],1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){e.descDialogVisible=!0}}},[e._v("查看说明")])],1),r("el-form-item",{attrs:{label:"SQL",prop:"sql"}},[r("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.ruleForm.sql,callback:function(t){e.$set(e.ruleForm,"sql",t)},expression:"ruleForm.sql"}})],1),r("el-form-item",{attrs:{label:"告警邮箱",prop:"email"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"配置多个请用逗号分隔"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}}),r("el-button",{staticStyle:{"margin-left":"10px",color:"gray"},attrs:{type:"text"}},[e._v("例:1242214@qq.com,242124@qq.com")])],1),r("el-form-item",[r("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("新增")])],1)],1),r("div",{staticStyle:{float:"right"}},[r("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 通用报表不符合?试试\n                "),r("router-link",{staticClass:"logout",attrs:{to:"/addSpecialTask"}},[e._v("定制化开发")])],1)],1)]),r("el-dialog",{attrs:{title:"【cron表达式生成规则】",visible:e.cronDialogVisible,width:"300px",center:""},on:{"update:visible":function(t){e.cronDialogVisible=t}}},[r("h6",[e._v("每天上午8点执行一次：0 0 8 * * ?")]),r("h6",[e._v("每天上午8点45分执行一次：0 45 8 * * ?")]),r("h6",[e._v("每小时5分执行：0 5 * * * ?")]),r("h6",[e._v("每小时的10分和40分执行：0 10,40 * * * ?")]),r("h5",[e._v("更复杂的表达式请参考: http://cron.qqe2.com/")])]),r("el-dialog",{attrs:{title:"【报表时间说明】",visible:e.descDialogVisible,width:"690px",center:""},on:{"update:visible":function(t){e.descDialogVisible=t}}},[r("p",{staticClass:"psmall"},[r("strong",[e._v("此字段代表报表的起止时间,即【我的报表】菜单中查询的开始时间和结束时间")])]),r("p",{staticClass:"psmall"},[r("strong",[e._v("按天：")]),e._v("起止时间分别为昨日零点和今日零点。\n        ")]),r("p",{staticStyle:{"margin-bottom":"10px",color:"gray"}},[e._v("例:跑批时间为2020-02-02 20:20,则起止时间为2020-02-01 00:00:00和2020-02-02 00:00:00")]),r("p",{staticClass:"psmall"},[r("strong",[e._v("按小时：")]),e._v("起止时间为上个小时(整点)和当前小时(整点)。\n        ")]),r("p",{staticStyle:{"margin-bottom":"10px",color:"gray"}},[e._v("例:跑批时间为2020-02-02 20:20,则起止时间为2020-02-02 19:00:00和2020-02-02 20:00:00")]),r("p",{staticClass:"psmall"},[r("strong",[e._v("按半小时：")]),e._v("时间间隔为半小时。\n        ")]),r("p",{staticStyle:{"margin-bottom":"10px",color:"gray"}},[e._v("例:跑批时间为2020-02-02 20:20分,则起止时间为2020-02-02 19:30:00和2020-02-02 20:00:00")]),r("p",{staticClass:"psmall"},[r("strong",[e._v("自定义：")]),e._v("sql中必须包含start_time和end_time,且形如yyyy-MM-dd HH:mm:ss 以sql中的时间为准。\n        ")]),r("p",{staticStyle:{color:"gray"}},[e._v("例:select '2020-02-01 00:00:00' as start_time,'2020-02-07 00:00:00' as end_time")])])],1)},a=[],o=r("bc3a"),s=r.n(o),i={name:"baseform",data:function(){return{cronDialogVisible:!1,descDialogVisible:!1,reportUser:[],ruleForm:{author:localStorage.getItem("ms_username"),reportName:"",reportDesc:"",dataSource:"",sql:"",authorizedPeople:"",metaDataJson:"",jobCron:"",reportFrequency:"",email:""},rules:{reportName:[{required:!0,message:"请输入报表名称(英文)",trigger:"blur"},{min:6,max:30,message:"长度在6到30个字符",trigger:"blur"}],reportDesc:[{required:!0,message:"请填写报表描述(中文)",trigger:"blur"},{min:4,max:30,message:"长度在4到30个字符",trigger:"blur"}],jobCron:[{required:!0,message:"请填写跑批时间(cron表达式)",trigger:"blur"}],metaDataJson:[{required:!0,message:"请填写元数据格式(json字符串)",trigger:"blur"}],authorizedPeople:[{required:!0,message:'请输入报表授权用户;"|"分割;如zhangsan|lisi',trigger:"blur"}],dataSource:[{required:!0,message:"请选择活动资源",trigger:"change"}],reportFrequency:[{required:!0,message:"请选择报表频率",trigger:"change"}],sql:[{required:!0,message:"请填写报表SQL",trigger:"blur"}]}}},mounted:function(){this.queryUser()},methods:{queryUser:function(){var e=this;s.a.post("/api/report/queryReportUser",this.ruleForm).then((function(t){200==t.data.code?e.reportUser=t.data.content:e.$message({message:t.data.msg,type:"error"})})).catch((function(t){e.$message({message:t,type:"error"})}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var r=JSON.parse(JSON.stringify(t.ruleForm));r.authorizedPeople=r.authorizedPeople.join("|"),s.a.post("/api/report/addCommonReport",r).then((function(e){200==e.data.code?(t.$message({message:"新增成功",type:"success"}),t.$router.push("/mytask")):t.$message({message:"新增异常:"+e.data.msg,type:"error"})})).catch((function(e){t.$message({message:e,type:"error"})}))}))}}},n=i,c=(r("d50d"),r("2877")),u=Object(c["a"])(n,l,a,!1,null,null,null);t["default"]=u.exports},d50d:function(e,t,r){"use strict";var l=r("5bdb"),a=r.n(l);a.a}}]);